function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}define ("tool_dataprivacy/selectedcourses",["exports","jquery","core/str","core/ajax","core/notification","core/modal_factory","core/modal_events","core/fragment"],function(a,b,c,d,f,g,h,i){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.showSelectedCoursesModal=void 0;b=l(b);c=k(c);d=l(d);f=l(f);g=l(g);h=l(h);i=l(i);function j(){if("function"!=typeof WeakMap)return null;var a=new WeakMap;j=function(){return a};return a}function k(a){if(a&&a.__esModule){return a}if(null===a||"object"!==_typeof(a)&&"function"!=typeof a){return{default:a}}var b=j();if(b&&b.has(a)){return b.get(a)}var c={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var e in a){if(Object.prototype.hasOwnProperty.call(a,e)){var f=d?Object.getOwnPropertyDescriptor(a,e):null;if(f&&(f.get||f.set)){Object.defineProperty(c,e,f)}else{c[e]=a[e]}}}c.default=a;if(b){b.set(a,c)}return c}function l(a){return a&&a.__esModule?a:{default:a}}function m(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function n(a,b,c){if(b in a){Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0})}else{a[b]=c}return a}var o=function a(e,j){var k=this;m(this,a);n(this,"contextId",0);n(this,"requestId",0);n(this,"strings",null);n(this,"getBody",function(a){var b=null;if("undefined"!=typeof a){b={jsonformdata:JSON.stringify(a)}}return i.default.loadFragment("tool_dataprivacy","selectcourses_form",k.contextId,b)});n(this,"setupFormModal",function(a,b){a.setLarge();a.setSaveButtonText(b);a.getRoot().on(h.default.hidden,k.destroy.bind(k));a.setBody(k.getBody({requesid:k.requestId}));a.getRoot().on(h.default.save,k.submitForm.bind(k));a.getRoot().on("submit","form",k.submitFormAjax.bind(k));k.modal=a;a.show()});n(this,"submitForm",function(a){a.preventDefault();k.modal.getRoot().find("form").submit()});n(this,"submitFormAjax",function(a){a.preventDefault();var c=k.modal.getRoot().find("form").serialize();if(-1===c.indexOf("coursecontextids")){var e=k.modal.getRoot().find(".custom-select"),g=k.modal.getRoot().find(".invalid-feedback");(0,b.default)(e).addClass("is-invalid");(0,b.default)(g).attr("style","display: block");k.strings.then(function(a){(0,b.default)(g).empty().append(a[2])}).fail(f.default.exception);return}d.default.call([{methodname:"tool_dataprivacy_submit_selected_courses_form",args:{requestid:k.requestId,jsonformdata:JSON.stringify(c)},done:function done(a){if(0<a.warnings.length){k.modal.setBody(k.getBody(c))}else{k.handleFormSubmissionResponse()}},fail:f.default.exception}])});n(this,"handleFormSubmissionResponse",function(){k.destroy();document.location.reload()});n(this,"destroy",function(){Y.use("moodle-core-formchangechecker",function(){M.core_formchangechecker.reset_form_dirty_state()});k.modal.destroy()});this.contextId=e;this.requestId=j;this.stringKeys=[{key:"selectcourses",component:"tool_dataprivacy"},{key:"save",component:"admin"},{key:"errornoselectedcourse",component:"tool_dataprivacy"}];this.strings=c.get_strings(this.stringKeys);this.strings.then(function(a){return g.default.create({type:g.default.types.SAVE_CANCEL,title:a[0],body:""}).done(function(b){k.setupFormModal(b,a[1])})}).fail(f.default.exception)};a.showSelectedCoursesModal=function showSelectedCoursesModal(a,b){return new o(a,b)}});
//# sourceMappingURL=selectedcourses.min.js.map
